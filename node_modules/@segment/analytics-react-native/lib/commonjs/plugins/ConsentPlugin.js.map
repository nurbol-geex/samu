{"version":3,"names":["_plugin","require","_types","_SegmentDestination","CONSENT_PREF_UPDATE_EVENT","ConsentPlugin","Plugin","type","PluginType","before","categories","queuedEvents","consentStarted","constructor","consentCategoryProvider","update","_settings","_type","consentSettings","analytics","get","allCategories","setApplicableCategories","configure","getPlugins","forEach","injectConsentFilterIfApplicable","onPluginLoaded","onConsentChange","notifyConsentChange","lastDeviceAttrs","context","device","onChange","c","newAttrs","adTrackingEnabled","advertisingId","trackingStatus","execute","event","consent","categoryPreferences","getConsentStatus","length","push","shutdown","plugin","isDestinationPlugin","add","ConsentFilterPlugin","settings","preferences","key","SEGMENT_DESTINATION_KEY","noneConsented","every","category","isConsentUpdateEvent","isConsentFeatureSetup","hasUnmappedDestinations","integrationSettings","containsConsentSettings","destination","track","catch","e","start","sendQueuedEvents","process","exports","shouldAllowEvent","undefined"],"sourceRoot":"../../../src","sources":["plugins/ConsentPlugin.ts"],"mappings":"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"}
